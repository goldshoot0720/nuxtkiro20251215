<!DOCTYPE html>
<html>
<head>
    <title>æ¸¬è©¦å½±ç‰‡æ¨™é ­</title>
</head>
<body>
    <h1>Netlify Blobs å½±ç‰‡æ¸¬è©¦</h1>
    
    <h2>å½±ç‰‡ 1: é‹’å…„çš„å‚³å¥‡äººç”Ÿ</h2>
    <video controls width="400">
        <source src="https://nuxtkiro20251215.netlify.app/api/blobs/19700121-1829-693fee512bec81918cbfd484c6a5ba8f_enx4rsS0.mp4" type="video/mp4">
        æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´å½±ç‰‡æ¨™ç±¤ã€‚
    </video>
    
    <h2>å½±ç‰‡ 2: é‹’å…„é€²åŒ–ShowğŸ”¥</h2>
    <video controls width="400">
        <source src="https://nuxtkiro20251215.netlify.app/api/blobs/clideo-editor-92eb6755d77b4603a482c25764865a58_7sLjgTgc.mp4" type="video/mp4">
        æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´å½±ç‰‡æ¨™ç±¤ã€‚
    </video>
    
    <h2>æ¸¬è©¦çµæœ</h2>
    <div id="results"></div>
    
    <script>
        async function testVideoHeaders() {
            const videos = [
                {
                    name: 'é‹’å…„çš„å‚³å¥‡äººç”Ÿ',
                    url: 'https://nuxtkiro20251215.netlify.app/api/blobs/19700121-1829-693fee512bec81918cbfd484c6a5ba8f_enx4rsS0.mp4'
                },
                {
                    name: 'é‹’å…„é€²åŒ–ShowğŸ”¥',
                    url: 'https://nuxtkiro20251215.netlify.app/api/blobs/clideo-editor-92eb6755d77b4603a482c25764865a58_7sLjgTgc.mp4'
                }
            ];
            
            const results = document.getElementById('results');
            
            for (const video of videos) {
                try {
                    console.log(`æ¸¬è©¦ ${video.name}...`);
                    
                    // HEAD è«‹æ±‚æ¸¬è©¦
                    const headResponse = await fetch(video.url, { method: 'HEAD' });
                    
                    const resultDiv = document.createElement('div');
                    resultDiv.innerHTML = `
                        <h3>${video.name}</h3>
                        <p><strong>ç‹€æ…‹:</strong> ${headResponse.status} ${headResponse.statusText}</p>
                        <p><strong>Content-Type:</strong> ${headResponse.headers.get('content-type')}</p>
                        <p><strong>Content-Length:</strong> ${headResponse.headers.get('content-length')} bytes</p>
                        <p><strong>Accept-Ranges:</strong> ${headResponse.headers.get('accept-ranges')}</p>
                        <p><strong>Cache-Control:</strong> ${headResponse.headers.get('cache-control')}</p>
                    `;
                    
                    // æ¸¬è©¦å‰ 12 å­—ç¯€
                    try {
                        const partialResponse = await fetch(video.url, {
                            headers: { 'Range': 'bytes=0-11' }
                        });
                        
                        if (partialResponse.ok) {
                            const buffer = await partialResponse.arrayBuffer();
                            const view = new Uint8Array(buffer);
                            const header = Array.from(view).map(b => b.toString(16).padStart(2, '0')).join(' ');
                            
                            // æª¢æŸ¥ MP4 æ¨™è­˜
                            const ftypCheck = new TextDecoder().decode(view.slice(4, 8));
                            
                            resultDiv.innerHTML += `
                                <p><strong>æ–‡ä»¶é ­:</strong> ${header}</p>
                                <p><strong>MP4 æ¨™è­˜:</strong> "${ftypCheck}" ${ftypCheck === 'ftyp' ? 'âœ…' : 'âŒ'}</p>
                            `;
                        }
                    } catch (rangeError) {
                        resultDiv.innerHTML += `<p><strong>ç¯„åœè«‹æ±‚å¤±æ•—:</strong> ${rangeError.message}</p>`;
                    }
                    
                    results.appendChild(resultDiv);
                    
                } catch (error) {
                    const errorDiv = document.createElement('div');
                    errorDiv.innerHTML = `
                        <h3>${video.name} - éŒ¯èª¤</h3>
                        <p style="color: red;">${error.message}</p>
                    `;
                    results.appendChild(errorDiv);
                }
            }
        }
        
        // é é¢è¼‰å…¥å¾ŒåŸ·è¡Œæ¸¬è©¦
        window.addEventListener('load', testVideoHeaders);
    </script>
</body>
</html>